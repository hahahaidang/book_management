<h1>MY REQUEST</h1>

<div class="div_myrequest">
<% if !@collection.blank? %>
      <div class='filter_form'>
          <%= form_tag '/manage_book/myrequest_page', method: 'get'  do %>
              <span>Filter by</span>
              <%= select_tag(:status,  options_for_select([['Pending',0],['Approved',1],['Denied',2]])) %>
              <button type="submit" class="glyphicon glyphicon-filter filter_button"></button>
          <% end  %>
      </div>
      <table class='table table-striped table-bordered' id="table">
        <thead class='thead-default'>
        <tr>
          <th>#</th>
          <th>Book</th>
          <th>Quantity</th>
          <th>Status</th>
          <th>Date</th>
        </tr>
        </thead>
        <tbody>
        <% @collection.each_with_index do |value , index|%>
            <tr>
              <td><%= index + 1  %></td>
              <td id="td_book_name" title='<%= value.book.book_name %>'>
                <a href="/welcome/detail/<%= value.id %>"><%= value.book.book_name %></a></td>
              <td><%= value.quantity %></td>
              <% if value.status == 0 %>
                  <td>Pending</td>
              <% else
                   if value.status == 1 %>
                      <td id="green">Approved</td>
                  <% else %>
                      <td id="red">Canceled</td>
                  <% end %>
              <% end %>
              <td class="time">
                <%= value.created_at.to_i*1000 %>
              </td>
              <% if value.status == 0  %>
                <!--Only request's status is pending-->
                <td>
                  <a href="/manage_book/cancel_request/<%= value.id %>" title="Cancel your request"><span class="glyphicon glyphicon-trash"></span></a>
                </td>
              <% end %>
            </tr>
        <% end %>
        </tbody>
      </table>
<% else %>
    <div id="notification">
      <label id="lb_notification">You have no request.</label>
    </div>
<% end %>
</div>
<div class="page-button">
  <%= will_paginate @collection, renderer: BootstrapPagination::Rails %>
</div>

<%= javascript_include_tag 'myrequest' %>
